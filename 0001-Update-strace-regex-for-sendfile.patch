From 3719a52d33fb8ef2628fb22ea8d7f4ca257bbd6d Mon Sep 17 00:00:00 2001
From: William Douglas <william.douglas@intel.com>
Date: Tue, 15 Nov 2016 23:40:00 +0000
Subject: [PATCH] Update strace regex for sendfile

---
 src/net/http/fs_test.go | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/src/net/http/fs_test.go b/src/net/http/fs_test.go
index c811891..e2fb8c6 100644
--- a/src/net/http/fs_test.go
+++ b/src/net/http/fs_test.go
@@ -1008,10 +1008,9 @@ func TestLinuxSendfile(t *testing.T) {
 	Post(fmt.Sprintf("http://%s/quit", ln.Addr()), "", nil)
 	child.Wait()
 
-	rx := regexp.MustCompile(`sendfile(64)?\(\d+,\s*\d+,\s*NULL,\s*\d+\)\s*=\s*\d+\s*\n`)
-	rxResume := regexp.MustCompile(`<\.\.\. sendfile(64)? resumed> \)\s*=\s*\d+\s*\n`)
+	rx := regexp.MustCompile(`sendfile(64)?\(\d+<.*>,\s*NULL,\s*\d+\)\s*=\s*\d+\s*\n`)
 	out := buf.String()
-	if !rx.MatchString(out) && !rxResume.MatchString(out) {
+	if !rx.MatchString(out) {
 		t.Errorf("no sendfile system call found in:\n%s", out)
 	}
 }
-- 
2.10.2

